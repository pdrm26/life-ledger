{% extends "base.html" %}
{% block title %}Dashboard - Finance App{% endblock %}
{% block content %}
    <!-- Summary Cards -->
    {% include 'components/summary_card.html' with total_income=total_income total_expense=total_expense net_balance=net_balance %}

    <!-- Action Buttons -->
    {% include 'components/action_buttons.html' %}

    <!-- Transactions List -->
    {% include 'components/tx_list.html' with transactions=transactions %}

    <!-- Modals -->
    {% include 'components/tx_modal.html' with modal_id='incomeModal' tx_type='income' color='green' %}
    {% include 'components/tx_modal.html' with modal_id='expenseModal' tx_type='expense' color='red' %}

    <script>
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.getElementById(modalId).classList.add('flex');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.getElementById(modalId).classList.remove('flex');
        }

        function setTransactionType(form, type) {
            form.querySelector('input[name="transaction_type"]').value = type;
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('bg-black')) {
                hideModal('incomeModal');
                hideModal('expenseModal');
            }
        });

        // Set today's date as default
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            const dateInputs = document.querySelectorAll('input[type="date"]');
            dateInputs.forEach(input => {
                if (!input.value) {
                    input.value = today;
                }
            });
        });
    </script>
{% endblock %}
